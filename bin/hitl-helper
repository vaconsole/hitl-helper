#!/usr/bin/env node
const program = require('commander')
const Database = require('better-sqlite3')
const {
  createJob,
  jsonCreateTable,
  insertJsonToTable,
  getJob,
  updateJob,
  submitJob,
  acceptJob,
  assignJob,
  rejectJob,
} = require('../lib/index')

program
  .command('create <dbPath> <sql> <pk> [description]')
  .action((dbPath, sql, pk, description = '') => {
    const db = new Database(dbPath)
    return createJob({ db, description, sql, pk })
  })

program
  .command('match <dbPath> <table> <indexColumns>')
  .action((dbPath, table, indexColumns) => {
    const db = new Database(dbPath)
    match(db, table, indexColumns.split(','))
  })

program.parse(process.argv)
